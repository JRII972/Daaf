// Copyright (c) 2023, SISEP - DAAF and contributors
// For license information, please see license.txt

frappe.ui.form.on("Exploitation", {
	refresh(frm) {

	},

   
});

function calcule_etp(frm, cdt, cdn){
    let row = frappe.get_doc(cdt, cdn);
        if ( row['nombre'] > 0 ){
            switch (row['type_contract']) {
                case "Moins d'un quart de temps" :
                    row['etp'] = row['nombre'] * 0.125
                    break;
                case "Un quart à moins d'un mi-temps" :
                    row['etp'] = row['nombre'] * 0.375
                    break;
                case "Mi-temps" :
                    row['etp'] = row['nombre'] * 0.5
                    break;
                case "Mi-temps moins 3/4 temps" :
                    row['etp'] = row['nombre'] * 0.625
                    break;
                case "3/4 de temps à moins d'un temps complet" :
                    row['etp'] = row['nombre'] * 0.875
                    break;
                case "Temps complet" :
                    row['etp'] = row['nombre'] * 1
                    break;
            }
            frm.refresh_field('table_main_oeuvre')
        } else {
            frappe.msgprint({
                title: __('Information'),
                indicator: 'orange',
                message: __('Le nombre d\'employés ne peux être négatif ou null !')
            });
        }
}

frappe.ui.form.on('Main d oeuvre', {
    // cdt is Child DocType name i.e Quotation Item
    // cdn is the row name for e.g bbfcb8da6a
    nombre(frm, cdt, cdn) {
        calcule_etp(frm, cdt, cdn)
    },
    type_contract(frm, cdt, cdn) {
        calcule_etp(frm, cdt, cdn)
    }
})